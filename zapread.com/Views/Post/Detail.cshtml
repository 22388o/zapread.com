@model zapread.com.Models.PostViewModel

@{
    ViewBag.Title = Model.Post.UserId.Name + ": in " + Model.Post.Group.GroupName + " - " + Model.Post.PostTitle;
    Model.IsDetailView = true;
}

@Html.Partial(partialViewName: "_PartialModalVote")         @*This is the code for the modal dialog box to vote*@

<div class="wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <br />
        <h2>@Model.Post.PostTitle</h2>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a>Posts</a></li>
            <li class="breadcrumb-item active">Detail</li>
        </ol>
    </div>
    <div class="col-lg-2">
    </div>
</div>

<div class="wrapper wrapper-content ">
    <div class="row">
        <div class="col-sm-2">
        </div>
        <div class="col-lg-8">
            @Html.Partial(partialViewName: "_PartialPostRender", model: Model)
            <div class="social-feed-box">
                <span></span>
            </div>
            <div class="social-feed-box" style="margin-bottom:50px;">
                <span></span>
            </div>
        </div>

    </div>
</div>

@section Scripts {
    @Scripts.Render("~/plugins/moment")

    <script type="text/javascript">
        var ub = 100;//
        var IsAuthenticated = "@Request.IsAuthenticated" == "True";

        $(document).ready(function () {
            // Collapse ibox function
            $('.collapse-link').on('click', function () {
                var ibox = $(this).closest('div.ibox');
                var button = $(this).find('i');
                var content = ibox.children('.ibox-content');
                content.slideToggle(200);
                button.toggleClass('fa-chevron-up').toggleClass('fa-chevron-down');
                ibox.toggleClass('').toggleClass('border-bottom');
                setTimeout(function () {
                    ibox.resize();
                    ibox.find('[id^=map-]').resize();
                }, 50);
            });

            // Close ibox function
            $('.close-link').on('click', function () {
                var content = $(this).closest('div.ibox');
                content.remove();
            });

            $(".c_input_" + "@Model.Post.PostId").summernote({
                callbacks: {
                    onImageUpload: function (files) {
                        that = $(this);
                        sendFile(files[0], that);
                    }
                },
                focus: false,
                placeholder: 'Write comment...',
                disableDragAndDrop: false,
                toolbar: ['bold', 'italic', 'underline', 'strikethrough', 'fontsize', 'color', 'link'],//false,
                minHeight: 60,
                maxHeight: 300,
                hint: {
                    match: /\B@@(\w*)$/,
                    search: function (keyword, callback) {
                        if (!keyword.length) return callback();
                        var msg = JSON.stringify({ 'searchstr': keyword.toString() })
                        $.ajax({
                            async: true,
                            url: '/Comment/GetMentions',
                            type: 'POST',
                            contentType: "application/json; charset=utf-8",
                            dataType: 'json',
                            data: msg,
                            error: function () {
                                callback();
                            },
                            success: function (res) {
                                callback(res.users);
                            }
                        });
                    },
                    content: function (item) {
                        //return '@@' + item;
                        //return $('<span />').addClass('badge').addClass('userhint').html('@@' + item)[0];
                        return $("<span class='badge badge-info userhint'>").html('@@' + item)[0];
                    }
                }
            });

            $(".c_input_" + "@Model.Post.PostId").each(function (i, e) {
                $(e).removeClass(".c_input_" + "@Model.Post.PostId");
            });
        });
    </script>
}